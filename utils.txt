utility functuons for version 2